{% extends 'base.html' %}
{% block title %}{{ title }}{% endblock %}

{% block content %}

{% if user.is_authenticated %}

    <div class="row mx-4">

        <!--div class="d-none d-md-block col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2"></div>
        <div class="d-none d-md-block col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-2 mb-2"></div-->

        <div class="
                col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12 col-xl-12 
                d-block d-xs-block d-md-block d-lg-none d-xl-none
                mx-0 px-0
            "
        >
            <div class="row">
                <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xs-6">
                    {% include 'layout/collate.html' with user=user jid=request.GET.jid only%}
                </div>
                <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xs-6">
                    <span 
                        class="rounded-pill btn btn-dark text-light"
                        onclick="
                            toggleById('presidential-race-top', false)
                            toggleById('parliamentary-race-top', false)
                            toggleById('presidential-race-map-box-sm', false)
                            toggleById('presidential-race-map-box-lg', true)
                            setPathLabels('lg')
                        "
                        style="overflow:hidden; height: 35px;"
                    >Regional Map</span>
                </div>
            </div>
        </div>


        <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-3 col-xl-3
                d-none d-xs-none d-md-none d-lg-block d-xl-block
                mb-2 mr-0 pr-0"
            style="position:relative;"
        >
            <div class="row"
                style="position:absolute; width:100%; z-index:30;"
            >

                <div class="col-12 mb-2x">

                    <div class="card-title bold mb-3">Welcome {{ user.username }}!</div>
                    
                    <a href="#"
                        hidden
                        onClick="
                            toggleByName('containers', false)
                            toggleById('containers-navigation', true)
                        "
                        class="rounded-pill btn btn-light">Navigation</a>
                </div>

                <div class="col-12 col-xs-12 col-sm-12 col-md-6 col-lg-12 col-xl-12 mx-0 px-0"
                >

                    <div hidden class="card text-dark border-light shadow-sm bg-light mb-3">
                        <div class="row card-body">
                            <div class="col-3">
                                <div class="asset-loading asset-loading-image"></div>
                            </div>
                            <div class="col-9">
                                <div class="asset-loading asset-loading-text"></div>
                                <div class="asset-loading asset-loading-text" style="width:60%"></div>
                                <div class="asset-loading asset-loading-text" style="width:40%"></div>
                            </div>
                        </div>
                    </div>

                    <a href="#"
                        class="card text-dark border-light shadow-sm mb-3x"
                    >
                        <div class="card-body">
                            <span class="card-title bold">Complete Reports</span>
                            <p class="card-text">View collation reports for races.</p>
                        </div>
                    </a>
                </div>


                <div class="col-12 col-xs-12 col-sm-12 col-md-4 col-lg-12 col-xl-12 mx-0 px-0">
                    <div class="card text-dark border-light shadow-sm bg-lightx mb-3x">
                        <div class="row card-bodyx mt-3 mx-2">
                            <div class="col-12" align="left" title="Collate Results">
                                {% include 'layout/collate.html' with user=user jid=request.GET.jid only%}
                                <!-- enqueue_callback='refreshDashBoard'-->
                            </div>
                        </div>
                    </div>
                </div>


                <div
                    class="col-12 col-xs-12 col-sm-12 col-md-4 col-lg-12 col-xl-12 mx-0 px-0"
                >
                    <div class="card text-dark border-light shadow-sm bg-lightx mb-3x">
                        <div class="card-body"
                            id="presidential-race-map-box-sm"
                            hidden
                        >
                            <div class="row">
                                <div class="col">
                                    <span class="card-title bold">Regional Presidential Wins</span>
                                </div>
                                <div class="col-6" align="right">
                                    <span
                                        name="chart--btns"
                                        id="chart--btns-1"
                                        onclick="
                                            toggleById('presidential-race-top', true)
                                            toggleById('parliamentary-race-top', true)
                                            toggleById('presidential-race-map-box-sm', false)
                                            toggleById('presidential-race-map-box-lg', false)
                                        "
                                        class="rounded-pill btn btn-light"
                                    >Close</span>
                                    <span
                                        name="chart--btns"
                                        id="chart--btns-1"
                                        onclick="
                                            toggleById('presidential-race-top', false)
                                            toggleById('parliamentary-race-top', false)
                                            toggleById('presidential-race-map-box-sm', false)
                                            toggleById('presidential-race-map-box-lg', true)
                                            setPathLabels('lg')
                                        "
                                        class="rounded-pill btn btn-light"
                                    >
                                        <i class="fa-solid fa-expand"></i>
                                    </span>
                                </div>
                            </div>

                            <div 
                                id="presidential-race-map-sm"
                                style="
                                    background-color: white;
                                    overflow: hidden;
                                "
                            >
                                {% include 'report/map.html' with id='sm' size='sm' user=user only%}
                            </div>
        
                        </div>
                    </div>
                </div>
    

                <div class="col-12 col-xs-12 col-sm-12 col-md-2 col-lg-12 col-xl-12 mx-0 px-0">

                    <div class="card text-dark border-light bg-light shadow-sm bg-lightx mb-3">
                        <div class="row card-body">
                            <div
                                class="col-12 col-xs-12 col-sm-5 col-md-12 col-lg-12 col-xl-4"
                                align="center"
                            >
                                <div class="bold f25">1st</div>
                                <div class="upper">place</div>
                            </div>
                            <div class="col d-block d-xs-block d-md-none d-lg-block d-xl-block" align="center">
                                <div class="mb-2">Presidential Race</div>
                                <div class="d-none d-xs-block d-sm-block d-md-none d-lg-block d-xl-block">
                                    <small hidden class="badge bg-info rounded-pill bold pointer">NDP</small>
                                    <span 
                                        class="rounded-pill btn btn-dark text-light"
                                        onclick="
                                            toggleById('presidential-race-map-box-sm', true)
                                            // setPathLabels('sm')
                                        "
                                    >View Regional Map</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div hidden class="card text-dark border-light shadow-sm bg-light mb-3">
                        <div class="row card-body">
                            <div class="col-12 col-xs-12 col-sm-5 col-md-5 col-lg-12 col-xl-5"
                                align="center"
                            >
                                <div class="bold" style="font-size: 35px;">
                                    2375
                                </div>
                                <div class="upper">seats</div>
                            </div>
                            <div class="col" align="center">
                                <div class="mb-2">Parliamentary Seats Won</div>
                                <small class="badge bg-info rounded-pill bold pointer">NDP</small>
                                <small class="badge bg-primary rounded-pill bold pointer">View Results</small>
                            </div>
                        </div>
                    </div>

                    <div hidden class="card text-dark border-light shadow-sm bg-light mb-3">
                        <div class="row card-body">
                            <div class="col-12 col-xs-12 col-sm-5 col-md-5 col-lg-12 col-xl-5"
                                align="center"
                            >
                                <div class="bold" style="font-size: 35px;">
                                    934k
                                </div>
                                <div class="upper">votes</div>
                            </div>
                            <div class="col" align="center">
                                <div class="mb-2">Total Voter Turnout</div>
                                <small class="badge bg-primary rounded-pill bold pointer">View Results</small>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>


        <div id="presidential-race-top"
            class="mb-3 col-12 col-xs-12 col-sm-12 col-md-6 col-lg-5 col-xl-5">
            <div
            >

                <div>
                    <div class="mb-2 row">
                        <div class="col-8 bold">Presidential Race (Top 3)</div>
                        <div class="col" align="right">
                            <a href="/reports/presidential/nation/"
                                class="rounded-pill btn btn-light"
                            >View Report</a>
                        </div>
                    </div>

                    <div id="presidential-race-organo">

                    <div
                        name="winning" id="winning-1"
                        class="card text-dark border-light shadow-sm bg-lightx mb-3x"
                    >
                        <div class="row card-body">
                            <div class="col-12" align="center">
                                {% include 'loading/profile_image.html' with name='top-presidential-profile-loading-0' %}
                                <img
                                    hidden
                                    id="top-presidential-profile-photo-0"
                                    class="img-fluidx rounded-circle avatar-border"
                                    width="38" height="38"
                                    />
                            </div>
                            <div class="col" align="center">
                                {% include 'loading/profile_text.html' with mode='top' name='top-presidential-profile-loading-0' %}
                                <div>
                                    <span
                                        hidden
                                        class="f18"
                                        id="top-presidential-profile-name-0"
                                    >Michael Esheh</span>
                                    <small
                                        hidden
                                        id="top-presidential-profile-position-0"
                                    >NDP</small>
                                </div>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-0"
                                    class="badge bg-info rounded-pill bold pointer"
                                >8.4M votes</small>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-percentage-0"
                                    class="badge bg-warning text-dark rounded-pill bold pointer"
                                >4%</small>
                            </div>
                        </div>
                        <div class="row card-body">
                            <div class="col-2" align="center">
                                {% include 'loading/profile_image.html' with name='top-presidential-profile-loading-1' %}
                                <img
                                    hidden
                                    id="top-presidential-profile-photo-1"
                                    class="img-fluidx rounded-circle avatar-border"
                                    width="32" height="32"
                                    />
                            </div>
                            <div class="col mb-3">
                                {% include 'loading/profile_text.html' with name='top-presidential-profile-loading-1' %}
                                <div>
                                    <span
                                        hidden
                                        id="top-presidential-profile-name-1"
                                    >Michael Esheh</span>
                                    <small
                                        hidden
                                        id="top-presidential-profile-position-1"
                                    >NDP</small>
                                </div>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-1"
                                    class="badge bg-info rounded-pill bold pointer"
                                >8.4M votes</small>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-percentage-1"
                                    class="badge bg-warning text-dark rounded-pill bold pointer"
                                >4%</small>
                            </div>
                            
                            <div class="col-2" align="center">
                                {% include 'loading/profile_image.html' with name='top-presidential-profile-loading-2' %}
                                <img
                                    hidden
                                    id="top-presidential-profile-photo-2"
                                    class="img-fluidx rounded-circle avatar-border"
                                    width="32" height="32"
                                    />
                            </div>
                            <div class="col">
                                {% include 'loading/profile_text.html' with name='top-presidential-profile-loading-2' %}
                                <div>
                                    <span
                                        hidden
                                        id="top-presidential-profile-name-2"
                                    >Bradley Davis Omi</span>
                                    <small
                                        hidden
                                        id="top-presidential-profile-position-2"
                                    >GCC Party</small>
                                </div>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-2"
                                    class="badge bg-danger rounded-pill bold pointer"
                                >3.4M votes</small>
                                <small
                                    hidden
                                    id="top-presidential-profile-vote-percentage-2"
                                    class="badge bg-warning text-dark rounded-pill bold pointer"
                                >4%</small>
                            </div>
                        </div>
                    </div>
                    <div
                        name="winning" id="winning-2"
                        class="card text-dark border-light shadow-sm bg-light mb-3"
                        hidden
                    >
                        <div class="row card-body">
                            <div class="col-2" align="center">
                                <img
                                    class="img-fluid rounded-circle avatar-border border-info"
                                    width="50" height="50"
                                    />
                            </div>
                            <div class="col">
                                <div>Karla Msong</div>
                                <small>NDP Party</small>
                                <small class="badge bg-info rounded-pill bold pointer">8.4M votes</small>
                            </div>
                            <div class="col" align="right">
                                <div>Gold Oseni</div>
                                <small>GCC Party</small>
                                <small class="badge bg-danger rounded-pill bold pointer">3.4M votes</small>
                            </div>
                            <div class="col-2" align="center">
                                <img
                                    class="img-fluid rounded-circle avatar-border border-danger"
                                    width="50" height="50"
                                    />
                            </div>
                        </div>
                    </div>

                    </div>

                </div>

                <div class="card text-dark bg-light border-light shadow-sm bg-lightx">
                    <div class="row card-bodyx mt-2 mb-2">
                        <div hidden class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xl-4 mb-3" align="center">
                            <div class="upper f13">polling stations</div>
                            <div class="bold f20">
                                <div name="presidential-polling-station-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <div id="presidential-polling-station-counts-percent" hidden>112</div>
                            </div>
                        </div>
                        <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6" align="center">
                            <div class="upper f13">polling stations declared</div>
                            <div class="bold f20">
                                <div name="presidential-polling-station-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <span id="presidential-polling-station-counts-declared" hidden>276</span>
                                <span id="presidential-polling-station-counts-declared-percent" hidden>276</span>
                            </div>
                        </div>
                        <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6" align="center">
                            <div class="upper f13">polling stations outstanding</div>
                            <div class="bold f20">
                                <div name="presidential-polling-station-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <span id="presidential-polling-station-counts-outstanding" hidden>164</span>
                                <span id="presidential-polling-station-counts-outstanding-percent" hidden>276</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>


        <div
            id="parliamentary-race-top"
            class="col-12 col-xs-12 col-sm-12 col-md-6 col-lg-4 col-xl-4"
        >
            <div class="row">
                <div class="col-6 bold mb-3">Parliamentary Race</div>
                <div class="col" align="right">
                    <a href="/reports/parliamentary/nation/"
                        class="rounded-pill btn btn-light"
                    >View Report</a>
                </div>
            </div>
            <div class="cardx text-dark border-light shadow-sm bg-lightx mb-3">

                <div class="row mx-2 mt-3">
                    <div
                        hidden
                        class="col-2 col-xs-1 col-sm-2 col-md-2 col-lg-2 col-xl-1"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-0" class="asset-loading asset-loading-image"></div>
                        <img
                            hidden
                            id="top-performers-profile-photo-0"
                            class="img-fluidx rounded-circle avatar-border"
                            width="25" height="25"
                            />
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-12 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-0">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-0"
                        >
                            <span
                                hidden
                                class="f20"
                                id="top-performers-profile-name-0"
                            >Koko Sim</span>
                            <small
                                hidden
                                id="top-performers-profile-position-0"
                            >Rep. NEW EDUBIASE, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-0"
                                class="badge bg-info rounded-pill bold pointer"
                            >3.8M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-0"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-2 col-xs-1 col-sm-2 col-md-2 col-lg-2 col-xl-1"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-1" class="asset-loading asset-loading-image"></div>
                        <img
                            hidden
                            id="top-performers-profile-photo-1"
                            class="img-fluidx rounded-circle avatar-border"
                            width="25" height="25"
                            />
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-1">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-1"
                        >
                            <span
                                hidden
                                class="f18"
                                id="top-performers-profile-name-1"
                            >Racheal Gosim</span>
                            <small
                                hidden
                                id="top-performers-profile-position-1"
                            >Rep. OBUASI WEST, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-1"
                                class="badge bg-info rounded-pill bold pointer"
                            >4.7M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-1"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-2 col-xs-1 col-sm-2 col-md-2 col-lg-2 col-xl-1"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-2" class="asset-loading asset-loading-image"></div>
                        <img
                            hidden
                            id="top-performers-profile-photo-2"
                            class="img-fluidx rounded-circle avatar-border"
                            width="25" height="25"
                            />
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-6 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-2">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-2"
                        >
                            <span
                                hidden
                                class="f18"
                                id="top-performers-profile-name-2"
                            >Mai Lui</span>
                            <small
                                hidden
                                id="top-performers-profile-position-2"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-2"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-2"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-3">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-3"
                        >
                            <small
                                hidden
                                id="top-performers-profile-name-3"
                            >Mai Lui</small>
                            <small
                                hidden
                                id="top-performers-profile-position-3"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-3"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-3"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-4">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-4"
                        >
                            <small
                                hidden
                                id="top-performers-profile-name-4"
                            >Mai Lui</small>
                            <small
                                hidden
                                id="top-performers-profile-position-4"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-4"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-4"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-5">
                            <div class="row">
                                <div class="col"></div>
                                <div class="col-3 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-5"
                        >
                            <small
                                hidden
                                id="top-performers-profile-name-5"
                            >Mai Lui</small>
                            <small
                                hidden
                                id="top-performers-profile-position-5"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-5"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-5"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-6 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-6">
                            <div class="row">
                                <div class="col-2 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-4"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-6"
                        >
                            <span
                                hidden
                                id="top-performers-profile-name-6"
                            >Mai Lui</span>
                            <small
                                hidden
                                id="top-performers-profile-position-6"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-6"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-6"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-7">
                            <div class="row">
                                <div class="col-2 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-4"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-7"
                        >
                            <span
                                hidden
                                id="top-performers-profile-name-7"
                            >Mai Lui</span>
                            <small
                                hidden
                                id="top-performers-profile-position-7"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-7"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-7"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-8">
                            <div class="row">
                                <div class="col-2 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-4"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-8"
                        >
                            <span
                                hidden
                                id="top-performers-profile-name-8"
                            >Mai Lui</span>
                            <small
                                hidden
                                id="top-performers-profile-position-8"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-8"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-8"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                    <div
                        hidden
                        class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-6 col-xl-4 mb-4"
                        align="center"
                    >
                        <div name="top-performers-profile-loading-9">
                            <div class="row">
                                <div class="col-2 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-1 asset-loading asset-loading-text"></div>
                                <div class="col-4"></div>
                            </div>
                        </div>
                        <a href="#" class="text-dark"
                            id="top-performers-profile-box-9"
                        >
                            <span
                                hidden
                                id="top-performers-profile-name-9"
                            >Mai Lui</span>
                            <small
                                hidden
                                id="top-performers-profile-position-9"
                            >Rep. ATWIMA NWABIAGYA SOUTH, NDP</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-9"
                                class="badge bg-info rounded-pill bold pointer">2.3M votes</small>
                            <small
                                hidden
                                id="top-performers-profile-vote-percentage-9"
                                class="badge bg-warning text-dark rounded-pill bold pointer"
                            >3%</small>
                        </a>
                    </div>
                </div>

                <div class="card text-dark border-light bg-light shadow-sm bg-lightx">
                    <div class="row card-bodyx mt-2 mb-2">
                        <div hidden class="col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xl-4 mb-3" align="center">
                            <div class="upper f13">seats won</div>
                            <div class="bold f20">
                                <div name="parliamentary-seat-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <div id="parliamentary-seat-counts-won" hidden>112</div>
                            </div>
                        </div>
                        <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6" align="center">
                            <div class="upper f13">seats outstanding</div>
                            <div class="bold f20">
                                <div name="parliamentary-seat-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <div id="parliamentary-seat-counts-outstanding" hidden>164</div>
                            </div>
                        </div>
                        <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6" align="center">
                            <div class="upper f13">seats declared</div>
                            <div class="bold f20">
                                <div name="parliamentary-seat-counts-loading" class="asset-loading asset-loading-text" style="width:50%"></div>
                                <div id="parliamentary-seat-counts-declared"hidden>276</div>
                            </div>
                        </div>
                        <div class="col-6 col-xs-6 col-sm-6 col-md-6 col-lg-6 col-xl-6" hidden>
                            <div class="mb-2">Parliamentary Seats Won</div>
                            <small class="badge bg-info rounded-pill bold pointer">NDP</small>
                            <small class="badge bg-primary rounded-pill bold pointer">View Results</small>
                        </div>
                    </div>
                </div>
    
            </div>
        </div>


        <div
            hidden
            id="presidential-race-map-box-lg"
            class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-9 col-xl-9"
        >
            <div class="row">
                <div class="col">
                    <span class="card-title bold">Regional Presidential Wins</span>
                </div>
                <div class="col-6" align="right">

                    <a href="{% url 'presidential_win_report' %}"
                        class="rounded-pill btn btn-light"
                    >View Report</a>

                    <span
                        name="chart--btns"
                        id="chart--btns-1"
                        onclick="
                            toggleById('presidential-race-top', true)
                            toggleById('parliamentary-race-top', true)
                            toggleById('presidential-race-map-box-sm', true)
                            toggleById('presidential-race-map-box-lg', false)
                        "
                        class="rounded-pill btn btn-light"
                    >
                        <i class="fa-solid fa-compress"></i>
                    </span>
                </div>
            </div>
            <div id="presidential-race-map-lg" style="min-height: 350px; overflow-x: auto;">
                {% include 'report/map.html' with id='lg' size='lg' user=user only%}
            </div>
        </div>


        <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-5 col-xl-4"
            style="min-height:200px;"
        >
            
            <div class="row">
                <div class="col-4 bold mt-1" id="pie-chart-title">Vote Validity</div>
                <div class="col-7 col-xs-8 col-sm-8 col-md-7 col-lg-7 col-xl-7" align="right">
                    <div class="overlay-container">
                        <small class="overlay mb-2">
                            <span
                                hidden
                                id="vote-count-btns-1"
                                name="vote-count-btns"
                                onClick="
                                    toggleChartDisplay({
                                        id: '1',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Vote Validity</span>
                            <span
                                hidden
                                id="vote-count-btns-2"
                                name="vote-count-btns"
                                hidden
                                onClick="
                                    toggleChartDisplay({
                                        id: '2',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">EC Variance</span>
                            <span
                                hidden
                                id="vote-count-btns-3"
                                name="vote-count-btns"
                                hidden
                                onClick="
                                    toggleChartDisplay({
                                        id: '3',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Votes by Position</span>
                            <span
                                hidden
                                id="vote-count-btns-4"
                                name="vote-count-btns"
                                onClick="
                                    toggleChartDisplay({
                                        id: '4',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Station</span>
                            <span
                                id="vote-count-btns-5"
                                name="vote-count-btns"
                                onClick="
                                    toggleChartDisplay({
                                        id: '5',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Party</span>
                            <span
                                hidden
                                id="vote-count-btns-6"
                                name="vote-count-btns"
                                onClick="
                                    toggleChartDisplay({
                                        id: '6',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Party Seats</span>
                            <span
                                hidden
                                id="vote-count-btns-7"
                                name="vote-count-btns"
                                onClick="
                                    toggleChartDisplay({
                                        id: '7',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Presidential Votes</span>
                            <span
                                hidden
                                id="vote-count-btns-8"
                                name="vote-count-btns"
                                hidden
                                onClick="
                                    toggleChartDisplay({
                                        id: '8',
                                        title: 'pie-chart-title',
                                        boxes: 'vote-counts',
                                        buttons: 'vote-count-btns',
                                    })
                                "
                                class="rounded-pill btn btn-light mb-2">Regional Counts</span>
                            <span
                                id="vote-count-btns-show"
                                name="vote-count-btns"
                                onClick="
                                    toggleByName('vote-count-btns', true)
                                    toggleById('vote-count-btns-show', false)
                                "
                                class="rounded-pill btn btn-light mb-2">...</span>
                        </small>
                    </div>
                </div>
            </div>

            <div class="row">

                {% include 'loading/pie_chart.html' with name='asset-loading-pie-chart-id' %}

                <div class="col" name="vote-counts" id="vote-counts-1" title="Vote Validity" hidden>
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-vote-validity" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-2" title="EC Variance" hidden>
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-ec-variance" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-3" title="Votes by Position" hidden>
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-vote-counts" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-4" title="Party Votes" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-party-votes" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-5" title="Station Votes" style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-station-votes" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-6" title="Seat Counts" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-seat-counts" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-7" title="Presidential Votes" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-presidential-votes" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-8" title="Votes by Region" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-regional-counts" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-9" title="Votes by Constituency (Top 5)" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-constituency-counts" height="200"></canvas>
                    </div>
                </div>
                <div class="col" name="vote-counts" id="vote-counts-10" title="Votes by Polling Station (Top 5)" hidden style="float:left; overflow:hidden;">
                    <div class="cardx text-dark border-lightx shadow-sm bg-lightx mb-3 pb-2">
                        <canvas id="pie-chart-station-counts" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        

        <div class="col-12 col-xs-12 col-sm-12 col-md-12 col-lg-7 col-xl-8 mb-3"
            style="min-height:300px !important;"
        >

            <a class="col-12" name="bar-charts"></a>

            <div class="bold mb-2">
                <div class="row">
                    <div class="col-3 bold mt-1" id="bar-chart-title">
                        Party Vote Distribution
                    </div>
                    <div class="col-9" align="right">
                        <div class="overlay-container">
                            <div class="overlay">
                                <span
                                    name="chart--btns"
                                    id="chart--btns-1"
                                    onClick="
                                        toggleChartDisplay({
                                            id: '1',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Party</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-2"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '2',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Station</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-3"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '3',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Presidential</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-4"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '4',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Parliamenatary</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-5"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '5',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Party Counts</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-6"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '6',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Station Counts</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-7"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '7',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Party Seats</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-8"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '8',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Regional Counts</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-9"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '9',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Constituency Counts</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-10"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '10',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Station Counts</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-11"
                                    hidden
                                    onClick="
                                        toggleChartDisplay({
                                            id: '11',
                                            title: 'bar-chart-title',
                                            boxes: 'charts',
                                            buttons: 'chart--btns',
                                        })
                                    "
                                    class="rounded-pill btn btn-light">Votes by Office</span>
                                <span
                                    name="chart--btns"
                                    id="chart--btns-show"
                                    onClick="
                                        toggleByName('chart--btns', true)
                                        toggleById('chart--btns-show', false)
                                    "
                                    class="rounded-pill btn btn-light mb-2">...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {% include 'loading/bar_chart.html' with name='asset-loading-bar-chart-id' %}

            <div id="charts-1" name="charts" title="Party Vote Distribution">
                <canvas id="bar-chart" height="120"></canvas>
            </div>
            <div id="charts-2" name="charts" title="Station Vote Distribution" hidden>
                <canvas id="bar-chart-2" height="120"></canvas>
            </div>
            <div id="charts-3" name="charts" title="Presiential Candidates" hidden>
                <canvas id="bar-chart-3" height="120"></canvas>
            </div>
            <div id="charts-4" name="charts" title="Parliamentary Candidates" hidden>
                <canvas id="bar-chart-4" height="130"></canvas>
            </div>
            <div id="charts-5" name="charts" title="Party Vote Distribution" hidden>
                <canvas id="bar-chart-5" height="130"></canvas>
            </div>
            <div id="charts-6" name="charts" title="Station Vote Distribution" hidden>
                <canvas id="bar-chart-6" height="120"></canvas>
            </div>
            <div id="charts-7" name="charts" title="Party Seats" hidden>
                <canvas id="bar-chart-7" height="120"></canvas>
            </div>
            <div id="charts-8" name="charts" title="Votes by Region (5)" hidden>
                <canvas id="bar-chart-regional-counts" height="120"></canvas>
            </div>
            <div id="charts-9" name="charts" title="Votes by Constituency (5)" hidden>
                <canvas id="bar-chart-constituency-counts" height="120"></canvas>
            </div>
            <div id="charts-10" name="charts" title="Votes by Station (5)" hidden>
                <canvas id="bar-chart-station-counts" height="120"></canvas>
            </div>
            <div id="charts-11" name="charts" title="Votes by Office" hidden>
                <canvas id="bar-chart-vote-counts" height="120"></canvas>
            </div>
        </div>

    </div>

    <script src="/static/map.js"></script>
        
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script type="module" src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

    <script>
    function pieConfig(pieData, options=null) {
        if (isNull(pieData)) { return null }
        var chartData = pieData.data
        var chartLabels = pieData.labels
        if (isNull(chartData)) { return null }
        const plugin = {
            id: 'customCanvasBackgroundColor',
            beforeDraw: (chart, args, options) => {
                const {ctx} = chart;
                ctx.save();
                ctx.globalCompositeOperation = 'destination-over';
                ctx.fillStyle = options.color || '#99ffff';
                ctx.fillRect(0, 0, chart.width, chart.height);
                ctx.restore();
            }
        };
        const pieColors = ['#696969', '#808080', '#A9A9A9', '#C0C0C0', '#D3D3D3']
        if (chartData[0] === 'number') {
            chartData = chartData
        } else {
            // console.log(chartData)
        }
        options = !isNull(options) ? options : {
            cutoutPercentage: 80,
            plugins: {
                customCanvasBackgroundColor: {
                    color: '#495057',
                },
            },
            responsive: true,
            legend: {
                position: 'chartArea',
                labels: {
                    boxHeight: 5,
                    boxWidth: 10,
                },
            },
        }
        return {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: chartData,
                    backgroundColor: pieData?.colors || pieColors,
                    label: 'Population'
                }],
                labels: chartLabels,
            },
            options: options,
            title: {
                display: true,
                text: 'Population Bar Chart'
            },
            // plugins: [plugin],
        };
    }

    function barConfig(barCharts) {
        if (isNull(barCharts)) { return null }

        const generalConfig = {
            // borderWidth: 2,
            // borderRadius: 5,
            barThickness: 9,
        }

        var dataSets = []
        var chartLabels = null
        barCharts.forEach(function (chart) {
            chartLabels = (isNull(chartLabels)) ? chart?.labels : chartLabels
            if (chart?.data) {
                dataSets.push({
                    label: chart?.title || '',
                    data: chart?.data,
                    backgroundColor: chart?.color || '#696969',
                    borderColor: chart?.color || '#696969',
                    ...generalConfig,
                })
            }
        })
        chartLabels = (isNull(chartLabels)) ? [] : chartLabels

        return {
            type: 'bar',
            data: {
                labels: chartLabels,
                datasets: dataSets,
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                legend: {
                    position: 'bottom',
                    labels: {
                        boxHeight: 5,
                        boxWidth: 10,
                    },
                },
                // maxBarThickness: 3,
                // barPercentage: 0.5,
                // title: {
                //     display: true,
                //     text: 'Population Bar Chart'
                // },
            },
        }
    }

    function hBarConfig(barData) {
        var chartData = barData.data
        var chartLabels = barData.labels
        config = {
            type: 'bar',
            data: chartData,
            options: {
                indexAxis: 'y',
                // Elements options apply to all of the options unless overridden in a dataset
                // In this case, we are setting the border of each horizontal bar to be 2px wide
                elements: {
                    bar: {
                        borderWidth: 2,
                    }
                },
                responsive: true,
                plugins: {
                    legend: {
                        position: 'right',
                    },
                    // title: {
                    //     display: true,
                    //     text: 'Chart.js Horizontal Bar Chart'
                    // }
                }
            },
        };
    }

    function fetchDashData(endPoint, callBack) {
        const apiUrl = '{{ api_base_url }}'
        const csrftoken = getCookie('csrftoken');
        const FETCH_URL = `${apiUrl}${endPoint}`
        const FETCH_CONFIG = {
            method: 'POST',
            credentials: 'same-origin',
            headers:{
                'Accept': 'application/json',
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest', //Necessary to work with request.is_ajax()
                'X-CSRFToken': csrftoken,
            },
            body: JSON.stringify({'post_data': 'Data to post'}) //JavaScript object of data to POST
        }

        fetch(FETCH_URL, FETCH_CONFIG,
        ).then(response => {
            return response.json()
        })
        .then(callBack)
    }

    const getNameInitials = (name) => {
        let nameAbbr = ''
        const nameParts = `${name}`.split(' ')
        const np = nameParts.length
        let n = 0
        for (part of nameParts) {
            nameAbbr += n == np - 1 ? part : part[0] + '. '
            n++
        }
        return nameAbbr
    }

    const refreshDashBoard = () => {
        fetchDashData(
            `reports/api/dashboard/`,
            data => {

                let doms = []
                let group_name
                let group_data
                var pieCtx
                var barCtx

                let ls;
                ls = document.getElementsByName('asset-loading-bar-chart-id')
                for (loading of ls) {
                    loading.hidden = true
                }
                ls = document.getElementsByName('asset-loading-pie-chart-id')
                for (loading of ls) {
                    loading.hidden = true
                }


                group_data = data?.parliamentary_top
                group_data?.list.forEach((top, t) => {
                    group_name = 'top-performers-profile-'
                    const loadings = document.getElementsByName(`${group_name}loading-${t}`)
                    const photo = document.getElementById(`${group_name}photo-${t}`)
                    const box = document.getElementById(`${group_name}box-${t}`)
                    const name = document.getElementById(`${group_name}name-${t}`)
                    const vote = document.getElementById(`${group_name}vote-${t}`)
                    const vote_percentage = document.getElementById(`${group_name}vote-percentage-${t}`)
                    const position = document.getElementById(`${group_name}position-${t}`)
                    doms = []
                    if (photo) {
                        // loadImage(photo, `${top.photo}`)
                        // doms.push(photo)
                        // votes=0,
                        // total_votes=0,
                    }
                    if (position) {
                        // position.innerHTML = `${top.position}`
                        // doms.push(position)
                    }
                    if (box) {
                        box.href = `${top?.party_seat_url}` || '#'
                        box.href += `${top?.party_id}`
                    }
                    if (name) {
                        name.innerHTML = `${top?.party_code}`
                        name.title = `${top?.party_title} (${top?.party_code})`
                        doms.push(name)
                    }
                    if (vote) {
                        vote.innerHTML = `${top?.seats}`
                        vote.title =  `${top?.seats}`
                        // for display space as t increase, horzontal space decreases
                        if (t <= 2) {
                            vote.innerHTML = `${top?.seats} seats`
                            vote.title =  `${top?.seats} seats`
                        }
                        doms.push(vote)
                    }
                    if (vote_percentage) {
                        vote_percentage.innerHTML = `${top?.vote_percentage}%`
                        vote_percentage.title =  `${top?.vote_percentage}%`
                        doms.push(vote_percentage)
                    }
                    for (dom of doms) {
                        dom.hidden = false
                    }
                    for (loading of loadings) {
                        loading.hidden = true
                    }
                })
                barCtx = document.getElementById('bar-chart-7').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]))
                pieCtx = document.getElementById('pie-chart-seat-counts').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));


                group_data = data?.presidential_top
                group_data?.list.forEach((top, t) => {
                    group_name = 'top-presidential-profile-'
                    const loadings = document.getElementsByName(`${group_name}loading-${t}`)
                    const photo = document.getElementById(`${group_name}photo-${t}`)
                    const name = document.getElementById(`${group_name}name-${t}`)
                    const vote = document.getElementById(`${group_name}vote-${t}`)
                    const vote_percentage = document.getElementById(`${group_name}vote-percentage-${t}`)
                    const position = document.getElementById(`${group_name}position-${t}`)
                    doms = []
                    if (photo) {
                        loadImage(photo, `${top.photo}`);
                        doms.push(photo)
                    }
                    if (name) {
                        name.title = `${top.name}`
                        name.innerHTML = getNameInitials(top.name)
                        doms.push(name)
                    }
                    if (vote) {
                        vote.innerHTML = `${top.votes_display} votes`
                        vote.title =  `${top.votes} votes`
                        doms.push(vote)
                    }
                    if (vote_percentage) {
                        vote_percentage.innerHTML = `${top.vote_percentage}%`
                        vote_percentage.title =  `${top.vote_percentage}`
                        doms.push(vote_percentage)
                    }
                    if (position) {
                        position.innerHTML = `${top.party}`
                        doms.push(position)
                    }
                    for (dom of doms) {
                        dom.hidden = false
                    }
                    for (loading of loadings) {
                        loading.hidden = true
                    }
                })
                var barCtx = document.getElementById('bar-chart-3').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]))
                var pieCtx = document.getElementById('pie-chart-presidential-votes').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));


                let geo_counts
                let loadings
                let won
                let outstanding
                let declared

                geo_counts = data?.polling_station_counts?.list
                group_name = 'presidential-polling-station-counts-'
                loadings = document.getElementsByName(`${group_name}loading`)
                percent = document.getElementById(`${group_name}percent`)
                declared = document.getElementById(`${group_name}declared`)
                declared_percent = document.getElementById(`${group_name}declared-percent`)
                outstanding = document.getElementById(`${group_name}outstanding`)
                outstanding_percent = document.getElementById(`${group_name}outstanding-percent`)
                ps_declared = geo_counts[0].seats
                ps_outstanding = geo_counts[1].seats
                ps_total = ps_declared + ps_outstanding
                ps_precent = Math.round((100 * ps_declared / ps_total) * 10) / 10
                out_precent = 100 - ps_precent
                percent.innerHTML = `${ps_precent}%`
                declared_percent.innerHTML = `(${ps_precent}%)`
                outstanding_percent.innerHTML = `(${out_precent}%)`
                declared.innerHTML = `${geo_counts[1].seats}`
                outstanding.innerHTML = `${geo_counts[0].seats}`
                percent.hidden = false
                outstanding.hidden = false
                declared.hidden = false
                outstanding_percent.hidden = false
                declared_percent.hidden = false
                for (loading of loadings) { loading.hidden = true }

                geo_counts = data?.seat_counts?.list
                group_name = 'parliamentary-seat-counts-'
                loadings = document.getElementsByName(`${group_name}loading`)
                won = document.getElementById(`${group_name}won`)
                outstanding = document.getElementById(`${group_name}outstanding`)
                declared = document.getElementById(`${group_name}declared`)
                won.innerHTML = `${geo_counts[0].seats}`
                outstanding.innerHTML = `${geo_counts[1].seats}`
                declared.innerHTML = `${geo_counts[2].seats}`
                won.hidden = false
                outstanding.hidden = false
                declared.hidden = false
                for (loading of loadings) { loading.hidden = true }


                const pieOptionsSmall = {
                    cutoutPercentage: 80,
                    responsive: true,
                    legend: {
                        position: 'bottom',
                        labels: {
                            boxHeight: 5,
                            boxWidth: 10,
                        },
                    },
                }

                const barChart = data?.bar

                const pieChart = data?.pie
                pieCtx = document.getElementById('pie-chart-party-votes').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(pieChart));
                barCtx = document.getElementById('bar-chart-6').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([pieChart]))


                const pieVoteValididityChart = data?.vote_validity
                pieCtx = document.getElementById('pie-chart-vote-validity').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(pieVoteValididityChart, pieOptionsSmall));

                const pieECVarianceChart = data?.ec_variance
                pieCtx = document.getElementById('pie-chart-ec-variance').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(pieECVarianceChart, pieOptionsSmall));

                // , 

                group_data = data?.votes_by_office
                pieCtx = document.getElementById('pie-chart-vote-counts').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));
                barCtx = document.getElementById('bar-chart-vote-counts').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]));

    
                group_data = data?.regional_counts
                pieCtx = document.getElementById('pie-chart-regional-counts').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));
                barCtx = document.getElementById('bar-chart-regional-counts').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]));

    
                group_data = data?.constituency_counts
                pieCtx = document.getElementById('pie-chart-constituency-counts').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));
                barCtx = document.getElementById('bar-chart-constituency-counts').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]));

    
                group_data = data?.station_counts
                pieCtx = document.getElementById('pie-chart-station-counts').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(group_data));
                barCtx = document.getElementById('bar-chart-station-counts').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([group_data]));
    

                const stationTotalChart = data?.station_total_votes
                const stationParliamentaryChart = data?.station_parliametary_votes
                const stationPresidentialChart = data?.station_presidential_votes
                var barCtx = document.getElementById('bar-chart-2').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([
                                                stationTotalChart,
                                                stationParliamentaryChart,
                                                stationPresidentialChart,
                                    ]));
 
 
                const partyTotalChart = data?.party_total_votes
                const partyParliamentaryChart = data?.party_parliametary_votes
                const partyPresidentialChart = data?.party_presidential_votes
                var pieCtx = document.getElementById('pie-chart-station-votes').getContext('2d');
                window.myPie = new Chart(pieCtx, pieConfig(partyTotalChart));
                var barCtx = document.getElementById('bar-chart').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([
                                                // partyTotalChart,
                                                partyParliamentaryChart,
                                                partyPresidentialChart,
                                            ])
                                    );
                var barCtx = document.getElementById('bar-chart-5').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([partyTotalChart]));


                const parliamentaryVotesByParty = data?.parliamentary_votes_by_party
                var barCtx = document.getElementById('bar-chart-4').getContext('2d');
                window.myBar = new Chart(barCtx, barConfig([parliamentaryVotesByParty]))


                buildMapWithChart('sm', data?.presidential_map_data?.list)
                buildMapWithChart('lg', data?.presidential_map_data?.list)

                /* pending
                data?.presidential_candidates
                */

            })
    }

    function toggleChartDisplay(props) {
        if (!props?.id || !props?.title || !props?.boxes || !props?.buttons) { return false }
        const title = document.getElementById(`${props?.title}`)
        const box = document.getElementById(`${props?.boxes}-${props?.id}`)
        if (title && box) { title.innerHTML = box?.title }
        toggleByName(`${props?.boxes}`, false)
        toggleByName(`${props?.buttons}`, false)
        toggleById(`${props?.boxes}-${props?.id}`, true)
        toggleById(`${props?.buttons}-${props?.id}`, true)
        toggleById(`${props?.buttons}-show`, true)
    }


    </script>
<script>

    function handleDomContentLoaded() {
        buildMap('sm')
        buildMap('lg')
        refreshDashBoard()
    }

    function handleResize() {
        // setPathLabels('sm')
        // setPathLabels('lg')
    }

    function handleScroll() {
        // setPathLabels('sm')
        // setPathLabels('lg')
    }

    window.addEventListener('DOMContentLoaded', handleDomContentLoaded);
    window.addEventListener('scroll', handleScroll);
    window.addEventListener('resize', handleResize);

</script>

{% endif %}

{% endblock %}